@model AssetsManagment.Models.StockItem


<div class="card-header" style="background:  #194771; color: white;">
    <div class="row">
        <div class="col-md-8">
            <h3 style="color: gold;">Items List</h3>



        </div>
        <div class="col-md-4" style="position: relative;">
            <div class="btnAllRow">
                <button title="Add Item"
                        style="margin: 2px;"
                        class="btn btn-success"
                        data-toggle="modal" id="myBtn" data-target=".bd-example-modal-lg">
                    <i class="fa fa-plus-circle" aria-hidden="true"></i>&nbsp;Add Item
                </button>
            </div>
        </div>
    </div>
</div>   
 <hr />


        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" data-backdrop="static"  aria-labelledby="myLargeModalLabel exampleModalCenterTitle" aria-hidden="true" id="itemModal">
             

                <div class="modal-dialog modal-lg bd-example-modal-lg ">
                    <div class="modal-content">
                        <div class="modal-header " style="background: #194771">
                            <h5 style=" float:left ;color:white" id="exampleModalLabelItem"></h5>
                            <p>  </p>
                            <button type="button"
                                    class="close"
                                    data-dismiss="modal"
                                    aria-label="Close"
                                    (click)="bsModalRef.hide()">
                                <span>&times;</span>
                            </button>
                        </div>

                        <div class="modal-body crudForm">
                            <div class="persoanlInfoArea">
                                <div class="row">

                                    <div class="col-md-8">

                                        <div class="row" style="display: none;">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Order Date</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">
                                                <input style="font-size: large; font-weight: bold;"
                                                       type="text"
                                                       id="strDate"
                                                       value=""
                                                       class="form-control"
                                                       readonly />
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Item Name</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">
                                                <input type="text" class="form-control" id="ItemName" placeholder="Name" />

                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Item Code</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">
                                                <input type="text" class="form-control" id="ItemCode" placeholder="Item Code" />

                                            </div>

                                        </div>

                                        @*<div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Item Description</h5>
                                            </div>

                                            <div class="col-sm-7 " style="margin: 5px;">

                                                <textarea type="text"
                                                          id="strItemDescription"
                                                          placeholder="Type Item Description in Here"
                                                          class="md-textarea md-textarea-auto form-control"
                                                          name="strItemDescription"></textarea>

                                            </div>
                                        </div>*@
                                    
                                        
                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Group</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">

                                                <div>
                                                    <select id="groupList" class="form-control">
                                                        <option value="">--Select One--</option>
                                                        @foreach (var group in ViewBag.groupList)
                                                        {
                                                            <option value="@group.NAME">@group.NAME</option>
                                                        }
                                                    </select>
                                                </div>

                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Brand</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">

                                                <div>
                                                    <select id="brandIdtest" class="form-control" onchange="brand_fn(this)">

                                                        <option value="">--Select One--</option>
                                                        @foreach (var brand in ViewBag.Brandlist)
                                                        {
                                                            <option id="@brand.intBrandID" value="@brand.BRAND_NAME">@brand.BRAND_NAME</option>

                                                        }
                                                    </select>
                                                </div>

                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px;">
                                                <h5 style="text-align: right;">Model</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">

                                                <div>
                                                    <select id="idModel" class="form-control" onchange="brand_fn(this)">

                                                        <option value="">--Select One--</option>
                                                        @foreach (var brand in ViewBag.Brandlist)
                                                        {
                                                            <option id="@brand.intBrandID" value="@brand.BRAND_NAME">@brand.BRAND_NAME</option>

                                                        }
                                                    </select>
                                                </div>

                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px; ">
                                                <h5 style="text-align: right;">Unit</h5>
                                            </div>
                                            <div class="col-sm-7 " style="margin: 5px;">
                                                <input type="text" class="form-control" id="strUnit" placeholder="Unit" />
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-sm-4" style="margin: 5px; ">
                                                <h5 style="text-align: right;">Inactive</h5>
                                            </div>
                                            <div class="form-group col-sm-6 ">

                                                <select class="form-control"
                                                        id="status"
                                                        name="catId">
                                                    <option>
                                                        yes
                                                    </option>
                                                    <option>
                                                        No
                                                    </option>
                                                </select>

                                            </div>
                                        </div>

                                    </div>

                                    <div class="col-md-4" style="padding: 15px;">
                                        <div style="background-color: wheat; padding: 10px;">
                                            <h1 style="text-align: center; color: green;">Total Qty</h1>
                                            <input style="font-size: 52px; font-weight: bold; color: red;text-align: center; background-color: white;"
                                                   type="text"
                                                   id="qtyTotal"
                                                   class="form-control"
                                                   readonly />


                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="control-label col-md-3">Picture</label>
                                            <div class="col-md-12" style="height:150px;">
                                                <img src="~/Image/products/defaultProduct.jpg" width="120" height="120" id="productImage" />
                                                <input type="file" class="form-control" id="btnBrowsePic">
                                            </div>
                                        </div>

                                    </div>

                                </div>

                                <div class="row">


                                </div>


                            </div>
                       

                            <div class="modal-body crudForm">
                                <div class="persoanlInfoArea">
                                    <form class="form-horizontal form-signin"
                                          (ngsubmit)="f.form.valid && onSaveOrUpdate(f)"
                                          #f="ngForm"
                                          novalidate
                                          action="index.html">

                                        <div class="row">
                                            <div class="col-sm-4 form-group">
                                                <label class="control-label">Location Name</label>
                                                <div>
                                                    <select id="responsid2" class="form-control">
                                                        <option value="">--Select One--</option>
                                                        @foreach (var item in ViewBag.reslist)
                                                        {
                                                            <option value="@item.strLocation">@item.strLocation</option>
                                                        }
                                                    </select>
                                                </div>
                                            </div>


                                            <div class="form-group col-md-2 ">
                                                <h5 for="productName">Quentity</h5>
                                                <input type="number"
                                                       class="form-control intQty"
                                                       name="productName"
                                                       onchange="calculateRate()"
                                                       id="intQty" />
                                            </div>
                                            <div class="form-group col-md-2">
                                                <h5 for="qty">Rate</h5>
                                                <input type="number"
                                                       class="form-control intRate"
                                                       name="intRate"
                                                       onchange="calculateRate()"
                                                       id="intRate" />

                                            </div>
                                           

                                            <div class="form-group col-md-2 ">
                                                <h5 for="rate">Amount</h5>
                                                <input type="number"
                                                       class="form-control"
                                                       id="itemAmount" />

                                            </div>
                                         
                                        </div>
                                        <br>

                                        <div class="form-group">
                                            <span><input type="button" class="btn btn-primary" id="btnAddlocation" onclick="addOrEditLocation();" value="Add"></input></span>
                                            <span><input type="button" class="btn btn-warning" id="btnClearlocation" onclick="cleardatda();" value="Clear"></input></span>
                                            @*<button type="submit" class="btn btn-dark"><i class="fa fa-plus"></i> Add to List</button>*@

                                        </div>
                                        <br>

                                    </form>

                                    <div class="table-responsive">
                                        <table id="itemDatatable" class="table table-striped table-bordered" style="width:100%"></table>
                                    </div>

                                
                                </div>
                            </div>

                            <div class="modal-footer justify-content-lg-end  border-0">
                                <span><input type="button" class="btn btn-primary" id="btnsaveItem" onclick="saveOrUpdates();" value="Save"></input></span>
                                <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="bsModalRef.hide()">Cancel</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

 

            <div class="table-responsive">
                <table id="datatable4" class="table table-striped table-bordered" style="width:100%"></table>
            </div>


  


        <script>
            var title = "Add Item";
            document.getElementById("exampleModalLabelItem").innerHTML = title;

            function readURL(input) {
                alert("check")
                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('#productImage').attr('src', e.target.result);
                    }

                    reader.readAsDataURL(input.files[0]); // convert to base64 string
                }
            }

            $("#btnBrowsePic").change(function () {
                readURL(this);
            });

            //$(".chosen").chosen();


            var lngSlNo;
            var selectdata = "";
            var title = "Add Stock Item";
            var todaydate = new Date();
            var locationList;
            var viewList;
            var selectGroup;
            var selectLocation;
            var itemRate=0;
            var itemQty=0;
            var itemAmount;
            var gLocationList = [];
            var qtyTotal = 0;
            var dblOpnRates = 0;
            var dblOpnValues = 0;
            var oldItemNameCode = "";

            var selectGroup;
            var selectlocationItem;
            var brandId;
            var brandName

            //var modal = document.getElementById("itemModal");
          
           
           

            document.getElementById("exampleModalLabel").innerHTML = title ;
            document.getElementById("strDate").value = todaydate.toLocaleDateString("en-US");;



            function brand_fn(select) {
                console.log("ddd");
                brandId =select.options[select.selectedIndex].id;
                brandName = select.options[select.selectedIndex].value;
            }
     
            function getData() {

                var itemName = $('#ItemName').val();
                var strItemGroup = $('#strItemGroup').val();
                var strUnit = $('#strUnit').val();
                var strItemDescription = $('#strItemDescription').val();
                var strDate = $('#strDate').val();
                var status = $('#status').val();

                console.log(itemName, strItemGroup, strUnit, strItemDescription, strDate);
            }

            function calculateRate() {

                itemRate = $('#intRate').val();
                itemQty = $('#intQty').val();
                //alert(itemQty)
                itemAmount = itemRate * itemQty;
                //alert(itemAmount)
                $("#itemAmount").val(itemAmount);
                console.log(itemRate, itemQty, itemAmount);

            }

            //function calculateRate() {

            //    itemRate = $('#intRate').val();
            //    itemQty = $('#intQty').val();
            //    itemAmount = itemRate * itemQty;
            //    document.getElementById("itemAmount").innerHTML = itemAmount;
            //    console.log(itemRate, itemQty, itemAmount);

            //}

            function addOrEditLocation() {
                btn = $('#btnAddlocation').val();
                if (btn == "Add") {
                    addLocation();
                } if (btn == "Update") {
                    updateLocation();

                }
            }

            function updateLocation() {
                alert("UpdateLocation");
                itemRate = $('#intRate').val();
                itemQty = $('#intQty').val();
                itemAmount = itemRate * itemQty;
                var locationId = selectLocation;
                console.log(gLocationList);
                qtyTotal = parseInt(0);

                for (i = 0; i < gLocationList.length; i++) {
                    if (gLocationList[i].strBranchName == locationId) {
                        gLocationList.splice(i, 1);
                        gLocationList.push({
                            intQty: itemQty,
                            dblBranchRate: itemRate,
                            dblBranchAmnout: itemAmount,
                          
                            strBranchName: locationId,

                        });
                        
                    }
                }
                for (i = 0; i < gLocationList.length; i++) {
                    qtyTotal += parseInt(gLocationList[i].intQty);
                    dblOpnValues += parseInt(gLocationList[i].dblBranchAmnout);
                }

                dblOpnRates = dblOpnValues / qtyTotal;

                cleardatda();
                document.getElementById("qtyTotal").value = qtyTotal;
                console.log("updateLocation",gLocationList);
                showlocationlview();
            }



            function addLocation() {
                selectLocation
                
                itemRate = $('#intRate').val();
                itemQty = $('#intQty').val();
                itemAmount = itemRate * itemQty;
                console.log("updateLocation selectLocation", selectLocation);
                var locationName = selectLocation;
                var strLocation = selectLocation;
                var result = false;
                console.log("gLocationList gLocationList", gLocationList);
                for (i = 0; i < gLocationList.length; i++) {
                    if (gLocationList[i].strBranchName == locationName) {

                        result = true;

                    }
                }
                if (result === false) {
                    console.log("result", result);
                    gLocationList.push({
                        intQty: itemQty,
                        dblBranchRate: itemRate,
                        dblBranchAmnout: itemAmount,
                        //strLocation: locationName,
                        strBranchName: locationName,
                        //lngSlNo: locationId

                    });
                    cleardatda();
                } else {
                    alert("You Alrady Add This Location");
                    return
                }

                console.log(gLocationList);
                qtyTotal = parseInt(0);

                for (i = 0; i < gLocationList.length; i++) {
                    qtyTotal += parseInt(gLocationList[i].intQty);
                    dblOpnValues += parseInt(gLocationList[i].dblBranchAmnout);
                }

                dblOpnRates = dblOpnValues / qtyTotal;
                 
                //for (i = 0; i < gLocationList.length; i++) {
                //    qtyTotal += parseInt(gLocationList[i].intQty);
                //    dblOpnRates += parseInt(gLocationList[i].dblBranchAmnout);
                //}
                console.log(qtyTotal);
               

                document.getElementById("qtyTotal").value = qtyTotal;

                console.log(gLocationList);
                showlocationlview();
 
            }

            function calculateData() {

                for (i = 0; i < gLocationList.length; i++) {
                    qtyTotal += parseInt(gLocationList[i].intQty);
                  
                }

                document.getElementById("qtyTotal").value = qtyTotal;

            }

            function showlocationlview() {
                $('#itemDatatable').DataTable({
                    data: gLocationList,
                    "bDestroy": true,
                   
                    //"scrollX": true,
                    "select": true,
                    
                    columns: [

                        {
                            title: 'SL',
                            render: function (
                                data,
                                type,
                                row,
                               meta
                            ) {
                                return '<span>' + (meta.row + 1) + '</span>';
                            },
                        },

                            //{ title: 'Location Name', data: 'strLocation' },
                            { title: 'Location Name', data: 'strBranchName' },
                            
                            { title: 'Qty', data: 'intQty', className: 'editable' },
                            { title: 'Rate', data: 'dblBranchRate', className: 'editable' },
                            { title: 'Amount', data: 'dblBranchAmnout' },
                             {
                                 title: 'Edit',
                                 render: function (data, type, row) {
                                     return '<button type="button"   class="btn btn-info fontsize  sales-sloat-ak">Edit</button>';
                                 }
                             },
                            //{
                            //    title: 'Qty',
                            //    render: function (data, type, row) {
                            //        return '<button type="button"   class="btn btn-danger fontsize  delete-sloat-ak">Delete</button>';
                            //    }
                            //},
                    ],
                    
                    "responsive": true,
                    "rowCallback": function (row, data) {
                        $(row)
                         .bind('click')
                         .click(function () {

                             selectlocationItem = data;
                             console.log('hello delete dataddddddddd', selectlocationItem);
                             //rerender();
                         });
                        $(row).find(".sales-sloat-ak").click(function () {
                            selectlocationItem = data;
                            console.log('hello edit dddeeeee', selectlocationItem);
                            editLocation(selectlocationItem);
                            //that.salesss(data);
                            //that.rerender();
                        });
                        $(row).find(".delete-sloat-ak").click(function () {
                            selectlocationItem = data;
                            //deletePack(selectdata.lngslNo)
                            //that.salesss(data);
                            //that.rerender();
                        });

                    }
                });
            }
            //$('#itemDatatable').on('click', 'tbody td.editable', function (e) {
            //    editor.inline(this);
            //});

            function editLocation(selectdata) {
                console.log('hello edit dddeeeee', selectdata);
                //$('#responsid2').val(selectdata.strLocation);
                //$('#responsid2').find(':selected').data(selectdata.strLocation);
                //row.find('.responsid2').val(selectdata.strLocation).trigger("change");


                $('#intRate').val(selectdata.dblBranchRate);
                $('#intQty').val(selectdata.intQty);
                $('#responsid2').val(selectdata.strBranchName).select2({ width: '100%' });
                document.getElementById("btnAddlocation").value = "Update";
            }

            $(document).ready(function () {
                showGrid();
               
                locationListShow();
                viewList = '@(ViewBag.reslist)';
                groupList = '@(ViewBag.groupList)';

                console.log('viewList viewList params', viewList);


                $("#responsid2").select2({ "width": '100%' });
                    $("#responsid2").focus();


                    $("#responsid2").on("change", function () {
                        selectLocation = $(this).val();

                 
                        console.log('params params params', selectLocation.lngSlNo, selectLocation);
 
                    });


                $("#groupList").select2({ "width": '100%' });
                $("#groupList").focus();
                $("#groupList").on("change", function () {
                    selectGroup = $(this).val();

         
                    console.log('params params params',  selectGroup);

                        
                        });


                var glist =  '@(ViewBag.reslist)';
                console.log('viewList viewList', glist);
                $("#glist").select2({
                    data: {
                        data: glist.strLocation
                    },
                    //data: glist
                })



                $(".chose-country").select2({
                   
                    placeholder: "Location",
                    theme: "classic",
                


                    ajax: {
                        url: '/Location/LocationList',
                        delay: 150,
                        width: 'resolve',
                        dataType: "json",
                     

                        "data": function (response) {
                            response.draw = response.draw;
                            response.recordsTotal = response.recordsTotal;
                            response.recordsFiltered = response.recordsFiltered;
                            console.log('request.data data data data responseText', response);
                             
                            return {
                                //searchTerm: params.term
                                results: response
                            };
                        },
                        

                        dataSrc: function (response) {
                            response.draw = response.data.draw;
                            response.recordsTotal = response.recordsTotal;
                            response.recordsFiltered = response.recordsFiltered;
                            console.log('request.data data data data responseText', response.data);
                            return response.data;
                        },
                    

                        processResults: function (response) {
                        
                            console.log('data data data', response);
                            response.draw = response.draw;
                            response.recordsTotal = response.recordsTotal;
                            response.recordsFiltered = response.recordsFiltered;
                            return {
                                results: response
                            };
                        },
                        minimumInputLength: 2,
                        width: 'resolve',
                       
                    },
                   
                });
            });
          

            function saveOrUpdates() {
                var btn = $('#btnsaveItem').val()
                if (btn == "Save") {
                    saveData();

                } else {

                    console.log('request.responseText', selectdata);
                    UpdateData();
                }

            }


            function saveimage(idd) {

                var fileUpload = $("#btnBrowsePic").get(0);
                var files = fileUpload.files;

                // Create FormData object  
                var fileData = new FormData();

                // Looping over all files and add it to FormData object  
                for (var i = 0; i < files.length; i++) {
          
                    fileData.append(files[i].name, files[i]);
                }
                 
                $.ajax({
                    url: '/Item/UploadFiles?id='+idd,
                    type: "POST",
                    contentType: false, // Not to set any content header  
                    processData: false, // Not to process data  
                    data: fileData,
                    success: function (result) {
                        showGrid();
                    },
                    error: function (err) {
                        alert(err.statusText);
                    }
                });

            }

        
            function saveData() {
                
                //alert(brandId);

                //alert(brandName);
                jQuery.ajaxSettings.traditional = true;
                var list = [];
                list = gLocationList;
                console.log('list list', list);
 
                var empObj = {
                  

                    strItemName: $('#ItemName').val(),
                    strItemGroup:selectGroup,
                    strUnit: $('#strUnit').val(),
                    strItemDescription: $('#strItemDescription').val(),
                    strDate: $('#strDate').val(),
                    strStatus: $('#status').val(),
                    dblOpnQty: qtyTotal,
                    dblOpnValue:dblOpnValues,
                    dblOpnRate:dblOpnRates,
                    gLocationList: list,
                    strBrand_ID: brandId,
                    strBrand_Name: brandName,
                   
                };
                console.log("sdfsfsdfsdf", empObj);

                $.ajax({
                    url: "/Item/saveDatad",
                    type: "POST",
                    data: JSON.stringify(empObj),
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                  
                        alert(result);
                        if (result != "error") {
                            
                            
                            var idd = result;
                            saveimage(idd);
                            $('#itemModal').modal('hide');
                            cleardatda();
                            showGrid();
                        } else {
                            alert("resutl is ", result);
                        };

                    }
                });
            }

            function cleardatda() {
                $("#datatable4").dataTable().fnDestroy();
                //$('#btnAddlocation').val("Add");


                $('#ItemName').val("");
                $('#strItemDescription').val("");
                $('#brandIdtest').val("");
                $('#groupList').val("");
                $('#strUnit').val("");
                $('#btnsaveItem').val("Save")


                $('#intRate').val("");
                $('#intRate').val("");
                $('#intQty').val("");

            }

            function UpdateData() {

                alert('lskdjfl');
                var list = [];
                list = gLocationList;
                console.log('list list', list);
                var empObj = {

                    lngSlNo: lngSlNo,

                    strItemName: $('#ItemName').val(),
                    strItemGroup: selectGroup,
                    strUnit: $('#strUnit').val(),
                    strItemDescription: $('#strItemDescription').val(),
                    strDate: $('#strDate').val(),
                    strStatus: $('#status').val(),
                    dblOpnQty: qtyTotal,
                    dblOpnValue: dblOpnValues,
                    dblOpnRate: dblOpnRates,
                    gLocationList: list,
                    strBrand_ID: brandId,
                    strBrand_Name: brandName,


                    //strItemName: $('#ItemName').val(),
                    //strItemGroup: selectGroup,
                    //strUnit: $('#strUnit').val(),
                    //strItemDescription: $('#strItemDescription').val(),
                    //strDate: $('#strDate').val(),
                    //strStatus: $('#status').val(),
                    //dblOpnQty: qtyTotal,
                    //gLocationList: list,
                    //strIOldtemcode: oldItemNameCode,

                };
                $.ajax({
                    url: "/Item/updateData",
                    type: "POST",
                    data: JSON.stringify(empObj),
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {

                        if (result == "Ok") {
                            var idd = result;
                            saveimage(idd);
                            $('#itemModal').modal('hide');
                            //cleardatda();
                            //showGrid();
                        } else {
                            cleardatda();
                            alert("resutl sssssis ", result);
                        };

                    }
                });


            }


            function locationListShow() {
               
                $.ajax({

                    url: "/Location/showGrid",
                    //data: JSON.stringify(empObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                    
                        if (result) {

                            console.log('request.result.data', result.data);
                            locationList = result.data;
                          
                        }
                    
                    }
                });

            }

            function showGrid() {
                $('#datatable4').DataTable({
                    "bDestroy": true,
                    
                   
                    "select": true,
                    "ajax": {
                        "url": "/Item/getStockItemList",
                        "type": "POST",
                        "datatype": "json",
                        "dataSrc": function (response) {
                            response.draw = response.data.draw;
                            response.recordsTotal = response.recordsTotal;
                            response.recordsFiltered = response.recordsFiltered;
                            console.log('request.responseText', response.data);
                            return response.data;
                        }
                    },

                  

                    "order": [[1, 'asc']],
                    "columns": [
                          {
                              title: 'SL',
                              render: function (
                                  data,
                                  type,
                                  row,
                                 meta
                              ) {
                                  return '<span>' + (meta.row + 1) + '</span>';
                              },
                          },
                        //{
                        //    return type == 'export' ? meta.row + 1 : data
                        //},

                         {
                             title: 'ID',
                             data: 'lngSlNo',
                             name: 'lngSlNo',
                         },
                         {
                             title: 'Item Name',
                             data: 'strItemName',
                             name: 'strItemName',
                         },
                         {
                             title: 'Group',
                             data: 'strItemGroup',
                             name: 'strAstrItemGroupddres1',
                         },
                         {
                             title: 'Opn-Qty',
                             data: 'dblOpnQty',
                             name: 'dblOpnQty',
                         },
                           

                           {
                               data:'imageSrc',
                               render: function (data) {  
  
                                   return '<img src=" ' + data + '" style="height:40px;width:40px;"/>';  
  
                               },
                           },

                         
                              {
                                  render: function (data, type, row) {
                                      return '<button class="btn btn-info fontsize  sales-sloat-ak">   <i class="fa fa-pencil"></i></button>' + "&nbsp" + '<button class="btn btn-danger fontsize  delete-sloat-ak"> <i class="fa fa-trash"></i></button>';
                                  }
                              },

                    ],
                    
                    "responsive": true,
                    "rowCallback": function (row, data) {
                        //$(row)
                        // .bind('click')
                        // .click(function () {

                        //     selectdata = data;
                        //     console.log('hello delete dataddddddddd', selectdata);
                        //     //rerender();
                        // });
                        $(row).find(".sales-sloat-ak").click(function () {
                            selectdata = data;
                            console.log('hello edit dddeeeee', selectdata);
                            edit(selectdata);
                            //that.salesss(data);
                            //that.rerender();
                        });
                        $(row).find(".delete-sloat-ak").click(function () {
                            selectdata = data;
                            deleteItemsById(selectdata.lngSlNo)
                            //that.salesss(data);
                            //that.rerender();
                        });

                    }

                });
            }




            function edit(selectdata) {

                $('#itemModal').modal('show');
                lngSlNo= selectdata.lngSlNo;
                $('#productImage').attr("src", selectdata.imageSrc);
                $('#ItemName').val(selectdata.strItemName);
                oldItemNameCode = selectdata.strItemName;
                $('#strUnit').val(selectdata.strItemGroup);
                $('#strItemDescription').val(selectdata.strItemDescription);
                //$('#strDate').val(selectdata.strPhone);
                $('#status').val(selectdata.strStatus);
                locationListByItemId(selectdata.strItemName);
                $('#groupList').val(selectdata.strItemGroup).select2({ width: '100%' });
                alert(selectdata.strBrand_Name)
                brandId = selectdata.strBrand_ID;
                $('#brandIdtest').val(selectdata.strBrand_Name).select2({ width: '100%' });
                calculateRate();
                $('#btnsaveItem').val("Update");
                $('#btnAdds').val("Update");

            }


            function locationListByItemId(id) {
                

                $.ajax({
                    url: "/Item/locationListByItemId?id=" + id,
                    //data: JSON.stringify(empObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        //alert("result ",result)
                        gLocationList = result;

                        if (gLocationList.length > 0) {

                            showlocationlview();
                            calculateData();
                        }

                        //loadData();
                        //$('#itemModal').modal('hide');
                       // if (result == "OK") {

                         //   cleardatda();
                         //   showGrid();

                            //alert("save data")
                            //$('.nav-tabs a[href="#tabLeaveApplicationList"]').tab('show');


                        //};
                        //error: function (errormessage) {
                        //    alert(errormessage.responseText);
                        //}

                    }
                });

            }

            function deleteItemsById(id) {

                $.ajax({
                    url: "/Item/deleteItemById?id=" + id,
                    //data: JSON.stringify(empObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        alert(result)
                        //loadData();
                        //$('#itemModal').modal('hide');
                        if (result == "OK") {

                            cleardatda();
                            showGrid();

                            //alert("save data")
                            //$('.nav-tabs a[href="#tabLeaveApplicationList"]').tab('show');


                        };
                        //error: function (errormessage) {
                        //    alert(errormessage.responseText);
                        //}

                    }
                });


            }

           
      
     

        </script>
